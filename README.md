# è¶…æµé‡ä¿æŠ¤ç³»ç»Ÿ ğŸ›¡ï¸

<div align="center">

**Traffic Limit Protection System**

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Shell Script](https://img.shields.io/badge/Shell-Bash-green.svg)](https://www.gnu.org/software/bash/)
[![Version](https://img.shields.io/badge/version-1.0.0-blue.svg)](https://github.com/oyport/traffic-limit-protection)

*ä¸€ä¸ªæ™ºèƒ½çš„ Linux æœåŠ¡å™¨æµé‡ç›‘æ§ä¸ä¿æŠ¤ç³»ç»Ÿï¼Œé˜²æ­¢å› æµé‡è¶…é™å¯¼è‡´çš„é«˜é¢è´¹ç”¨*

[åŠŸèƒ½ç‰¹æ€§](#åŠŸèƒ½ç‰¹æ€§) â€¢ [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹) â€¢ [ä½¿ç”¨æŒ‡å—](#ä½¿ç”¨æŒ‡å—) â€¢ [é…ç½®è¯´æ˜](#é…ç½®è¯´æ˜) â€¢ [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

</div>

---

## ğŸ“– é¡¹ç›®ç®€ä»‹

è¶…æµé‡ä¿æŠ¤ç³»ç»Ÿæ˜¯ä¸€ä¸ªä¸“ä¸º Linux æœåŠ¡å™¨è®¾è®¡çš„è‡ªåŠ¨åŒ–æµé‡ç›‘æ§ä¸ä¿æŠ¤è§£å†³æ–¹æ¡ˆã€‚å½“æœåŠ¡å™¨æµé‡æ¥è¿‘æˆ–è¶…è¿‡é¢„è®¾é˜ˆå€¼æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨é‡‡å–åˆ†çº§å“åº”æªæ–½ï¼Œæœ‰æ•ˆé˜²æ­¢å› æµé‡è¶…é™è€Œäº§ç”Ÿçš„é«˜é¢è´¹ç”¨ã€‚

### é€‚ç”¨åœºæ™¯

- ğŸŒ **VPS/äº‘æœåŠ¡å™¨** - é˜²æ­¢æµé‡è¶…å‡ºå¥—é¤é™åˆ¶
- ğŸ’° **æŒ‰æµé‡è®¡è´¹æœåŠ¡å™¨** - é¿å…æ„å¤–æµé‡è´¹ç”¨
- ğŸ”’ **é«˜å®‰å…¨è¦æ±‚ç¯å¢ƒ** - DDoS æ”»å‡»æ—¶è‡ªåŠ¨é™æµä¿æŠ¤
- ğŸš€ **å°å‹ç½‘ç«™/API æœåŠ¡** - æµé‡å¼‚å¸¸æ—¶è‡ªåŠ¨é™çº§ä¿æŠ¤

---

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½

#### ğŸ¯ åˆ†çº§å“åº”æœºåˆ¶
```
80% â”€â”€â”€â”€> ğŸ“Š æ—¥å¿—è®°å½• + é€šçŸ¥å‘Šè­¦
90% â”€â”€â”€â”€> ğŸ”¶ è½¯é˜»æ–­ï¼ˆä¿ç•™ SSHï¼Œé˜»æ–­é«˜æµé‡ç«¯å£ï¼‰
95% â”€â”€â”€â”€> ğŸ”´ ç¡¬é˜»æ–­ï¼ˆç¦ç”¨ç½‘å¡æˆ–é˜»æ–­æ‰€æœ‰æµé‡ï¼‰
100% â”€â”€â”€> âš ï¸ å¯é€‰å…³æœºä¿æŠ¤
```

#### ğŸ› ï¸ çµæ´»çš„é˜»æ–­ç­–ç•¥

**è½¯é˜»æ–­æ¨¡å¼**ï¼ˆ90% è§¦å‘ï¼‰
- âœ… ä¿ç•™ SSH ç­‰å…³é”®ç«¯å£è®¿é—®
- âœ… ç™½åå• IP åœ°å€ä¸å—å½±å“
- âŒ é˜»æ–­ HTTP/HTTPS ç­‰é«˜æµé‡ç«¯å£
- ğŸ¯ é€‚åˆç´§æ€¥é™æµä½†éœ€ä¿æŒç®¡ç†è®¿é—®

**ç¡¬é˜»æ–­æ¨¡å¼**ï¼ˆ95% è§¦å‘ï¼‰
- ğŸ”’ é˜»æ–­æ‰€æœ‰ç½‘ç»œæµé‡ï¼ˆä»…ä¿ç•™æœ¬åœ°å›ç¯ï¼‰
- ğŸ“´ å¯é€‰ç¦ç”¨ç½‘å¡ï¼ˆéœ€æ‰‹åŠ¨é‡å¯æ¢å¤ï¼‰
- ğŸš¨ æç«¯ä¿æŠ¤æªæ–½

#### ğŸ“Š å¼ºå¤§çš„ç»Ÿè®¡åŠŸèƒ½

```bash
# å®æ—¶æµé‡ç›‘æ§
tx-ctl status           # å½“å‰çŠ¶æ€ + è¿›åº¦æ¡å¯è§†åŒ–

# å¤šç»´åº¦ç»Ÿè®¡åˆ†æ
tx-ctl stats summary    # æœ¬æœˆ/ä»Šæ—¥æµé‡æ¦‚è§ˆ
tx-ctl stats daily      # æ¯æ—¥æµé‡è¶‹åŠ¿
tx-ctl stats hourly     # 24å°æ—¶è¯¦ç»†ç»Ÿè®¡
tx-ctl stats export     # å¯¼å‡º CSV æ•°æ®
```

#### ğŸ”” å¤šæ¸ é“é€šçŸ¥

- ğŸ“§ **é‚®ä»¶é€šçŸ¥** - é€šè¿‡ `mail` å‘½ä»¤å‘é€
- ğŸŒ **Webhook** - æ”¯æŒè‡ªå®šä¹‰ HTTP å›è°ƒ
- ğŸ’¬ **é›†æˆæ”¯æŒ** - Slackã€Discordã€Telegramï¼ˆé¢„ç•™ï¼‰
- ğŸ“ **å®¡è®¡æ—¥å¿—** - æ‰€æœ‰æ“ä½œå®Œæ•´è®°å½•

#### ğŸ©º ç³»ç»Ÿå¥åº·æ£€æŸ¥

```bash
tx-ctl doctor
```
è‡ªåŠ¨æ£€æµ‹ï¼š
- âœ“ vnstat æœåŠ¡çŠ¶æ€
- âœ“ é˜²ç«å¢™é…ç½®æ­£ç¡®æ€§
- âœ“ Cron ä»»åŠ¡é…ç½®
- âœ“ ç½‘å¡çŠ¶æ€
- âœ“ ç£ç›˜ç©ºé—´
- âœ“ æ—¥å¿—æ–‡ä»¶å¤§å°

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç³»ç»Ÿè¦æ±‚

- **æ“ä½œç³»ç»Ÿ**: Linux (Ubuntu/Debian/CentOS/RHEL/Rocky/AlmaLinux)
- **æƒé™**: Root æˆ– sudo
- **ä¾èµ–**: `bash`, `vnstat`, `jq`, `iptables`

### ä¸€é”®å®‰è£…

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/oyport/traffic-limit-protection.git
cd traffic-limit-protection

# è¿è¡Œå®‰è£…è„šæœ¬
sudo bash install.sh
```

### å®‰è£…è¿‡ç¨‹

å®‰è£…è„šæœ¬ä¼šå¼•å¯¼æ‚¨å®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š

1. **ä¾èµ–æ£€æŸ¥ä¸å®‰è£…** - è‡ªåŠ¨å®‰è£… vnstatã€jq ç­‰å¿…éœ€ç»„ä»¶
2. **ç½‘å¡é€‰æ‹©** - æ™ºèƒ½è¯†åˆ«å¯ç”¨ç½‘å¡
3. **äº¤äº’å¼é…ç½®** - è®¾ç½®æµé‡é˜ˆå€¼ã€å“åº”åŠ¨ä½œç­‰
4. **è‡ªåŠ¨éƒ¨ç½²** - é…ç½®å®šæ—¶ä»»åŠ¡ã€åˆå§‹åŒ–æœåŠ¡

### ç«‹å³å¯ç”¨

```bash
# å¯ç”¨ç›‘æ§
sudo tx-ctl enable

# æŸ¥çœ‹çŠ¶æ€
sudo tx-ctl status

# å¥åº·æ£€æŸ¥
sudo tx-ctl doctor
```

---

## ğŸ“š ä½¿ç”¨æŒ‡å—

### åŸºç¡€æ“ä½œ

#### å¯ç”¨/ç¦ç”¨ç›‘æ§

```bash
# å¯ç”¨ç›‘æ§
sudo tx-ctl enable

# ç¦ç”¨ç›‘æ§ï¼ˆä¸ä¼šæ¸…é™¤é˜²ç«å¢™è§„åˆ™ï¼‰
sudo tx-ctl disable

# è§£é™¤æ‰€æœ‰é˜»æ–­
sudo tx-ctl unblock
```

#### æŸ¥çœ‹çŠ¶æ€

```bash
# å®Œæ•´çŠ¶æ€æŠ¥å‘Šï¼ˆåŒ…æ‹¬å¯è§†åŒ–è¿›åº¦æ¡ï¼‰
sudo tx-ctl status

# ç¤ºä¾‹è¾“å‡ºï¼š
# ========================================
#   è¶…æµé‡ä¿æŠ¤ç³»ç»Ÿ - çŠ¶æ€æŠ¥å‘Š
# ========================================
# 
# â— ç›‘æ§çŠ¶æ€: å·²å¯ç”¨
# â— ç›‘æ§ç½‘å¡: eth0
# â— æµé‡é˜ˆå€¼: 30000 MB
# â— å½“å‰æµé‡: 15420 MB / 30000 MB (51%)
#   [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 51%
# â— é˜»æ–­çŠ¶æ€: æ­£å¸¸è¿è¡Œ
```

#### æµé‡ç»Ÿè®¡

```bash
# ç»¼åˆç»Ÿè®¡
sudo tx-ctl stats

# æ¯æ—¥æµé‡
sudo tx-ctl stats daily

# å°æ—¶ç»Ÿè®¡ï¼ˆæœ€è¿‘24å°æ—¶ï¼‰
sudo tx-ctl stats hourly

# è¯¦ç»†åˆ†æ
sudo tx-ctl stats detail

# å¯¼å‡ºæ•°æ®
sudo tx-ctl stats export
```

#### æ—¥å¿—æŸ¥çœ‹

```bash
# æŸ¥çœ‹æœ€è¿‘50è¡Œæ—¥å¿—
sudo tx-ctl logs

# æŸ¥çœ‹æœ€è¿‘200è¡Œ
sudo tx-ctl logs 200

# å®æ—¶è·Ÿè¸ªæ—¥å¿—
sudo tail -f /var/log/tx-monitor.log
```

### é«˜çº§æ“ä½œ

#### å¿«é€Ÿè°ƒæ•´é˜ˆå€¼

```bash
# è®¾ç½®é˜ˆå€¼ä¸º 50GB
sudo tx-ctl set-threshold 50000

# è®¾ç½®é˜ˆå€¼ä¸º 100GB
sudo tx-ctl set-threshold 100000
```

#### æµ‹è¯•é…ç½®

```bash
# æµ‹è¯•è¿è¡Œï¼ˆä¸ä¼šæ‰§è¡Œå®é™…åŠ¨ä½œï¼‰
sudo tx-ctl test

# å¼ºåˆ¶ç«‹å³æ£€æŸ¥
sudo tx-ctl force-check
```

#### é˜²ç«å¢™è§„åˆ™ç®¡ç†

```bash
# æŸ¥çœ‹å½“å‰é˜²ç«å¢™è§„åˆ™
sudo tx-ctl rules show

# æ¸…é™¤æ‰€æœ‰ç›‘æ§ç›¸å…³è§„åˆ™
sudo tx-ctl rules clear
```

#### ç¼–è¾‘é…ç½®

```bash
# ä½¿ç”¨é»˜è®¤ç¼–è¾‘å™¨ç¼–è¾‘é…ç½®æ–‡ä»¶
sudo tx-ctl config
```

---

## âš™ï¸ é…ç½®è¯´æ˜

### é…ç½®æ–‡ä»¶ä½ç½®

- **ä¸»é…ç½®**: `/etc/tx-monitor.conf`
- **ç¤ºä¾‹é…ç½®**: `tx-monitor.conf.example`

### æ ¸å¿ƒé…ç½®é¡¹

```bash
# åŸºç¡€é…ç½®
INTERFACE="eth0"                 # ç›‘æ§çš„ç½‘å¡
THRESHOLD_MB=30000              # æœˆæµé‡é˜ˆå€¼ï¼ˆMBï¼‰
CHECK_INTERVAL=10               # æ£€æŸ¥é—´éš”ï¼ˆåˆ†é’Ÿï¼‰

# å“åº”é˜ˆå€¼
WARNING_LEVEL_1=80              # ç¬¬ä¸€çº§è­¦å‘Šï¼ˆ%ï¼‰
WARNING_LEVEL_2=90              # è½¯é˜»æ–­è§¦å‘ç‚¹ï¼ˆ%ï¼‰
WARNING_LEVEL_3=95              # ç¡¬é˜»æ–­è§¦å‘ç‚¹ï¼ˆ%ï¼‰

# å“åº”åŠ¨ä½œ
ACTION_AT_90="block_ports"      # 90% æ—¶: è½¯é˜»æ–­
ACTION_AT_95="disable_interface" # 95% æ—¶: ç¡¬é˜»æ–­-ç¦ç”¨ç½‘å¡
ACTION_AT_100="alert"           # 100% æ—¶: ä»…å‘Šè­¦

# ç«¯å£é…ç½®
WHITELIST_PORTS="22,443"        # è½¯é˜»æ–­æ—¶ä¿ç•™çš„ç«¯å£
BLOCK_PORTS="80,8080,3000"      # è½¯é˜»æ–­æ—¶ä¼˜å…ˆé˜»æ–­çš„ç«¯å£
WHITELIST_IPS=""                # ç™½åå•IPåœ°å€

# é€šçŸ¥é…ç½®
ENABLE_NOTIFICATIONS=true       # å¯ç”¨é€šçŸ¥
NOTIFICATION_EMAIL=""           # é‚®ä»¶åœ°å€
WEBHOOK_URL=""                  # Webhookåœ°å€
```

### åŠ¨ä½œç±»å‹è¯´æ˜

| é…ç½®é¡¹ | å¯é€‰å€¼ | è¯´æ˜ |
|--------|--------|------|
| `ACTION_AT_90` | `block_ports` | é˜»æ–­éå¿…è¦ç«¯å£ï¼ˆè½¯é˜»æ–­ï¼‰ |
|  | `alert` | ä»…å‘é€å‘Šè­¦é€šçŸ¥ |
| `ACTION_AT_95` | `disable_interface` | ç¦ç”¨ç½‘å¡ï¼ˆéœ€æ‰‹åŠ¨æ¢å¤ï¼‰ |
|  | `block_all` | é˜»æ–­æ‰€æœ‰æµé‡ |
|  | `alert` | ä»…å‘é€å‘Šè­¦é€šçŸ¥ |
| `ACTION_AT_100` | `shutdown` | âš ï¸ ç«‹å³å…³æœº |
|  | `alert` | ä»…å‘é€å‘Šè­¦é€šçŸ¥ |

### é¢„è®¾æ¨¡æ¿

#### ä½æµé‡æ¨¡æ¿ï¼ˆ10GBï¼‰
```bash
THRESHOLD_MB=10000
WARNING_LEVEL_1=80
WARNING_LEVEL_2=90
WARNING_LEVEL_3=95
```
é€‚ç”¨ï¼šä¸ªäººåšå®¢ã€å±•ç¤ºç«™ç‚¹

#### å‡è¡¡æ¨¡æ¿ï¼ˆ50GBï¼‰
```bash
THRESHOLD_MB=50000
WARNING_LEVEL_1=80
WARNING_LEVEL_2=90
WARNING_LEVEL_3=95
```
é€‚ç”¨ï¼šå°å‹ç½‘ç«™ã€API æœåŠ¡

#### é«˜æµé‡æ¨¡æ¿ï¼ˆ100GBï¼‰
```bash
THRESHOLD_MB=100000
WARNING_LEVEL_1=85
WARNING_LEVEL_2=92
WARNING_LEVEL_3=97
```
é€‚ç”¨ï¼šä¸šåŠ¡æœåŠ¡å™¨ã€è§†é¢‘ç«™ç‚¹

---

## ğŸ”§ å‘½ä»¤å‚è€ƒ

### tx-ctl å®Œæ•´å‘½ä»¤åˆ—è¡¨

```bash
# ç›‘æ§æ§åˆ¶
tx-ctl enable                    # å¯ç”¨ç›‘æ§
tx-ctl disable                   # ç¦ç”¨ç›‘æ§
tx-ctl status                    # æŸ¥çœ‹çŠ¶æ€
tx-ctl unblock                   # è§£é™¤é˜»æ–­

# æµé‡ç»Ÿè®¡
tx-ctl stats [ç±»å‹]              # æµé‡ç»Ÿè®¡
  - summary   (é»˜è®¤) ç»¼åˆç»Ÿè®¡
  - daily     æ¯æ—¥æµé‡
  - monthly   æ¯æœˆæµé‡
  - hourly    å°æ—¶æµé‡
  - detail    è¯¦ç»†åˆ†æ
  - export    å¯¼å‡ºCSV

# æ—¥å¿—æŸ¥çœ‹
tx-ctl logs [è¡Œæ•°]               # æŸ¥çœ‹æ—¥å¿—ï¼ˆé»˜è®¤50è¡Œï¼‰

# æµ‹è¯•ä¸æ£€æŸ¥
tx-ctl test                      # æµ‹è¯•é…ç½®
tx-ctl force-check               # å¼ºåˆ¶æ£€æŸ¥
tx-ctl doctor                    # å¥åº·æ£€æŸ¥

# é…ç½®ç®¡ç†
tx-ctl config                    # ç¼–è¾‘é…ç½®
tx-ctl set-threshold <MB>        # å¿«é€Ÿè®¾ç½®é˜ˆå€¼
tx-ctl reset                     # é‡ç½®ç»Ÿè®¡æ•°æ®

# é˜²ç«å¢™è§„åˆ™
tx-ctl rules show                # æ˜¾ç¤ºè§„åˆ™
tx-ctl rules clear               # æ¸…é™¤è§„åˆ™

# å…¶ä»–
tx-ctl help                      # å¸®åŠ©ä¿¡æ¯
tx-ctl version                   # ç‰ˆæœ¬ä¿¡æ¯
```

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
traffic-limit-protection/
â”œâ”€â”€ tx-monitor.sh              # æ ¸å¿ƒç›‘æ§è„šæœ¬
â”œâ”€â”€ tx-ctl                     # ç®¡ç†æ§åˆ¶å·¥å…·
â”œâ”€â”€ install.sh                 # ä¸€é”®å®‰è£…è„šæœ¬
â”œâ”€â”€ uninstall.sh               # å¸è½½è„šæœ¬
â”œâ”€â”€ test.sh                    # æµ‹è¯•å¥—ä»¶
â”œâ”€â”€ tx-monitor.conf.example    # é…ç½®æ–‡ä»¶ç¤ºä¾‹
â”œâ”€â”€ README.md                  # é¡¹ç›®æ–‡æ¡£
â””â”€â”€ LICENSE                    # MIT è®¸å¯è¯
```

### ç³»ç»Ÿæ–‡ä»¶ä½ç½®

```
/usr/local/bin/
â”œâ”€â”€ tx-monitor.sh              # ç›‘æ§è„šæœ¬
â””â”€â”€ tx-ctl                     # æ§åˆ¶å·¥å…·

/etc/
â””â”€â”€ tx-monitor.conf            # é…ç½®æ–‡ä»¶

/var/log/
â”œâ”€â”€ tx-monitor.log             # è¿è¡Œæ—¥å¿—
â””â”€â”€ tx-monitor-audit.log       # å®¡è®¡æ—¥å¿—

/run/
â”œâ”€â”€ tx-monitor.enabled         # å¯ç”¨æ ‡è®°
â”œâ”€â”€ tx-monitor.soft-block      # è½¯é˜»æ–­æ ‡è®°
â”œâ”€â”€ tx-monitor.hard-block      # ç¡¬é˜»æ–­æ ‡è®°
â””â”€â”€ tx-monitor.last-action     # æœ€ååŠ¨ä½œæ—¶é—´
```

---

## ğŸ” å®‰å…¨ç‰¹æ€§

### é»˜è®¤å®‰å…¨æœºåˆ¶

1. **æ‰‹åŠ¨å¯ç”¨** - å®‰è£…åé»˜è®¤ç¦ç”¨ï¼Œéœ€æ‰‹åŠ¨å¯ç”¨
2. **é‡å¯ä¿æŠ¤** - ç³»ç»Ÿé‡å¯åè‡ªåŠ¨ç¦ç”¨ç›‘æ§ï¼ˆé˜²æ­¢è¯¯é”å®šï¼‰
3. **SSH ä¿æŠ¤** - è½¯é˜»æ–­å’Œç¡¬é˜»æ–­å§‹ç»ˆä¿ç•™ SSH è®¿é—®
4. **ç™½åå•æœºåˆ¶** - æ”¯æŒ IP å’Œç«¯å£ç™½åå•
5. **å®¡è®¡æ—¥å¿—** - å®Œæ•´è®°å½•æ‰€æœ‰æ“ä½œå’Œé…ç½®å˜æ›´
6. **å†·å´æœŸ** - é˜²æ­¢çŸ­æ—¶é—´å†…é‡å¤æ‰§è¡Œé˜»æ–­åŠ¨ä½œ

### æ¢å¤æ–¹å¼

#### è¿œç¨‹æ¢å¤ï¼ˆSSH å¯ç”¨ï¼‰
```bash
# è§£é™¤é˜»æ–­
sudo tx-ctl unblock

# ç¦ç”¨ç›‘æ§
sudo tx-ctl disable
```

#### æœ¬åœ°æ¢å¤ï¼ˆæ§åˆ¶å°ï¼‰
```bash
# æ¸…é™¤é˜²ç«å¢™è§„åˆ™
sudo iptables -F TX_MONITOR_BLOCK
sudo iptables -X TX_MONITOR_BLOCK
sudo iptables -P OUTPUT ACCEPT

# å¯ç”¨ç½‘å¡
sudo ip link set eth0 up

# åˆ é™¤å¯ç”¨æ ‡è®°
sudo rm -f /run/tx-monitor.enabled
```

---

## ğŸ“Š å·¥ä½œåŸç†

### ç›‘æ§æµç¨‹

```mermaid
graph TD
    A[Cron å®šæ—¶è§¦å‘] --> B{æ£€æŸ¥å¯ç”¨æ ‡è®°}
    B -->|å·²ç¦ç”¨| C[é€€å‡º]
    B -->|å·²å¯ç”¨| D[ä» vnstat è·å–æµé‡æ•°æ®]
    D --> E[è®¡ç®—ä½¿ç”¨ç™¾åˆ†æ¯”]
    E --> F{æµé‡ç­‰çº§åˆ¤æ–­}
    F -->|< 80%| G[æ­£å¸¸è¿è¡Œ]
    F -->|80-89%| H[è®°å½•æ—¥å¿— + å‘é€é€šçŸ¥]
    F -->|90-94%| I[æ‰§è¡Œè½¯é˜»æ–­]
    F -->|95-99%| J[æ‰§è¡Œç¡¬é˜»æ–­]
    F -->|â‰¥ 100%| K[ç´§æ€¥å“åº”]
    I --> L[ä¿ç•™ SSH + é˜»æ–­é«˜æµé‡ç«¯å£]
    J --> M[ç¦ç”¨ç½‘å¡ / é˜»æ–­æ‰€æœ‰æµé‡]
    K --> N{é…ç½®æ£€æŸ¥}
    N -->|shutdown| O[å…³æœº]
    N -->|alert| P[å‘Šè­¦]
```

### é˜²ç«å¢™è§„åˆ™ç»“æ„ï¼ˆè½¯é˜»æ–­ç¤ºä¾‹ï¼‰

```bash
# åˆ›å»ºè‡ªå®šä¹‰é“¾
iptables -N TX_MONITOR_BLOCK

# ç™½åå•ç«¯å£ï¼ˆSSHï¼‰
iptables -A TX_MONITOR_BLOCK -p tcp --dport 22 -j ACCEPT

# ç™½åå•IP
iptables -A TX_MONITOR_BLOCK -d 1.2.3.4 -j ACCEPT

# é˜»æ–­é«˜æµé‡ç«¯å£
iptables -A TX_MONITOR_BLOCK -p tcp --dport 80 -j DROP
iptables -A TX_MONITOR_BLOCK -p tcp --dport 443 -j DROP

# é»˜è®¤ä¸¢å¼ƒ
iptables -A TX_MONITOR_BLOCK -j DROP

# åº”ç”¨åˆ° OUTPUT é“¾
iptables -I OUTPUT -o eth0 -j TX_MONITOR_BLOCK
```

---

## â“ å¸¸è§é—®é¢˜

### Q: å®‰è£…åä¸ºä»€ä¹ˆä¸ä¼šè‡ªåŠ¨å¼€å§‹ç›‘æ§ï¼Ÿ

**A:** å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œç³»ç»Ÿå®‰è£…åé»˜è®¤ç¦ç”¨ã€‚éœ€æ‰‹åŠ¨è¿è¡Œ `sudo tx-ctl enable` å¯ç”¨ç›‘æ§ã€‚

---

### Q: ç³»ç»Ÿé‡å¯åç›‘æ§è¿˜ä¼šè¿è¡Œå—ï¼Ÿ

**A:** ä¸ä¼šã€‚ç³»ç»Ÿé‡å¯åç›‘æ§è‡ªåŠ¨ç¦ç”¨ï¼Œéœ€é‡æ–°å¯ç”¨ã€‚è¿™æ˜¯å®‰å…¨è®¾è®¡ï¼Œé˜²æ­¢é…ç½®é”™è¯¯å¯¼è‡´æœåŠ¡å™¨æ— æ³•è®¿é—®ã€‚

---

### Q: å¦‚æœè¢«è¯¯é˜»æ–­æ€ä¹ˆåŠï¼Ÿ

**A:** 
1. é€šè¿‡ SSH è¿æ¥ï¼ˆè½¯é˜»æ–­ä¿ç•™ SSH ç«¯å£ï¼‰
2. è¿è¡Œ `sudo tx-ctl unblock` è§£é™¤é˜»æ–­
3. å¦‚æœ SSH æ— æ³•è¿æ¥ï¼Œéœ€é€šè¿‡æ§åˆ¶å°è®¿é—®æœåŠ¡å™¨

---

### Q: vnstat æ•°æ®ä¸å‡†ç¡®æ€ä¹ˆåŠï¼Ÿ

**A:** 
```bash
# é‡ç½® vnstat ç»Ÿè®¡
sudo tx-ctl reset

# æˆ–æ‰‹åŠ¨é‡ç½®
sudo vnstat -i eth0 --remove
sudo vnstat -i eth0 --add

# é‡å¯ vnstat æœåŠ¡
sudo systemctl restart vnstat
```

---

### Q: å¦‚ä½•ä¸´æ—¶æé«˜é˜ˆå€¼ï¼Ÿ

**A:**
```bash
# å¿«é€Ÿè®¾ç½®æ–°é˜ˆå€¼ï¼ˆå•ä½ï¼šMBï¼‰
sudo tx-ctl set-threshold 50000

# æˆ–ç¼–è¾‘é…ç½®æ–‡ä»¶
sudo tx-ctl config
```

---

### Q: æ”¯æŒå¤šç½‘å¡ç›‘æ§å—ï¼Ÿ

**A:** å½“å‰ç‰ˆæœ¬ä»…æ”¯æŒå•ç½‘å¡ç›‘æ§ã€‚å¦‚éœ€ç›‘æ§å¤šç½‘å¡ï¼Œå¯ä»¥ï¼š
1. åˆ›å»ºå¤šä»½é…ç½®æ–‡ä»¶
2. ä¿®æ”¹è„šæœ¬ä½¿ç”¨ä¸åŒé…ç½®
3. åˆ†åˆ«è®¾ç½® cron ä»»åŠ¡

---

### Q: å¦‚ä½•å®Œå…¨å¸è½½ï¼Ÿ

**A:**
```bash
cd traffic-limit-protection
sudo bash uninstall.sh
```
å¸è½½è„šæœ¬ä¼šï¼š
- åœæ­¢ç›‘æ§
- æ¸…é™¤é˜²ç«å¢™è§„åˆ™
- åˆ é™¤ cron ä»»åŠ¡
- åˆ é™¤ç³»ç»Ÿè„šæœ¬
- å¯é€‰ä¿ç•™/åˆ é™¤é…ç½®å’Œæ—¥å¿—
- å¯é€‰å¸è½½ä¾èµ–åŒ…

---

### Q: æµé‡ç»Ÿè®¡ä»ä»€ä¹ˆæ—¶å€™å¼€å§‹ï¼Ÿ

**A:** vnstat ä»å®‰è£…æ—¶å¼€å§‹æ”¶é›†æ•°æ®ã€‚å¦‚æœæ˜¯æ–°å®‰è£…çš„æœåŠ¡å™¨ï¼Œå»ºè®®ç­‰å¾…å‡ å°æ—¶è®© vnstat ç§¯ç´¯æ•°æ®åå†å¯ç”¨ç›‘æ§ã€‚

---

## ğŸ› ï¸ æ•…éšœæ’é™¤

### vnstat æœåŠ¡æœªè¿è¡Œ

```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
sudo systemctl status vnstat

# å¯åŠ¨æœåŠ¡
sudo systemctl start vnstat

# è®¾ç½®å¼€æœºè‡ªå¯
sudo systemctl enable vnstat
```

### é˜²ç«å¢™è§„åˆ™æ— æ³•ç”Ÿæ•ˆ

```bash
# æ£€æŸ¥ iptables æ˜¯å¦å®‰è£…
sudo iptables -L

# æŸ¥çœ‹å½“å‰è§„åˆ™
sudo tx-ctl rules show

# æ¸…é™¤å¹¶é‡æ–°åº”ç”¨
sudo tx-ctl unblock
sudo tx-ctl force-check
```

### æ— æ³•å‘é€é€šçŸ¥

```bash
# æ£€æŸ¥ mail å‘½ä»¤ï¼ˆé‚®ä»¶é€šçŸ¥ï¼‰
command -v mail

# æµ‹è¯• Webhook
curl -X POST "$WEBHOOK_URL" \
  -H "Content-Type: application/json" \
  -d '{"test":"message"}'
```

### æ—¥å¿—æ–‡ä»¶è¿‡å¤§

```bash
# æ‰‹åŠ¨è½®è½¬æ—¥å¿—
sudo mv /var/log/tx-monitor.log /var/log/tx-monitor.log.old
sudo touch /var/log/tx-monitor.log
```

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç ã€æŠ¥å‘Šé—®é¢˜æˆ–æå‡ºå»ºè®®ï¼

### æŠ¥å‘Šé—®é¢˜

åœ¨ [Issues](https://github.com/oyport/traffic-limit-protection/issues) é¡µé¢æŠ¥å‘Šé—®é¢˜æ—¶ï¼Œè¯·åŒ…å«ï¼š

- æ“ä½œç³»ç»Ÿç‰ˆæœ¬
- vnstat ç‰ˆæœ¬ (`vnstat --version`)
- é”™è¯¯æ—¥å¿— (`sudo tx-ctl logs 100`)
- é…ç½®æ–‡ä»¶å†…å®¹ï¼ˆéšè—æ•æ„Ÿä¿¡æ¯ï¼‰

### æäº¤ Pull Request

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

---

## ğŸ“‹ å¼€å‘è®¡åˆ’

### v1.1.0 è®¡åˆ’åŠŸèƒ½

- [ ] Web ç®¡ç†ç•Œé¢
- [ ] æµé‡å›¾è¡¨å¯è§†åŒ–
- [ ] å¤šç½‘å¡åŒæ—¶ç›‘æ§
- [ ] è‡ªå®šä¹‰æ—¶é—´èŒƒå›´ç»Ÿè®¡
- [ ] è‡ªåŠ¨æ¢å¤æœºåˆ¶
- [ ] Docker å®¹å™¨æ”¯æŒ
- [ ] IPv6 æ”¯æŒ
- [ ] æ›´å¤šé€šçŸ¥æ¸ é“ï¼ˆé’‰é’‰ã€ä¼ä¸šå¾®ä¿¡ï¼‰

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT License](LICENSE) å¼€æºè®¸å¯è¯ã€‚

```
MIT License

Copyright (c) 2026 oyport

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction...
```

---

## ğŸ™ è‡´è°¢

æœ¬é¡¹ç›®åŸºäºä»¥ä¸‹å¼€æºå·¥å…·ï¼š

- [vnstat](https://humdi.net/vnstat/) - ç½‘ç»œæµé‡ç›‘æ§
- [jq](https://stedolan.github.io/jq/) - JSON å¤„ç†
- [iptables](https://www.netfilter.org/) - é˜²ç«å¢™ç®¡ç†

---

## ğŸ“§ è”ç³»æ–¹å¼

- **ä½œè€…**: oyport
- **é¡¹ç›®ä¸»é¡µ**: [https://github.com/oyport/traffic-limit-protection](https://github.com/oyport/traffic-limit-protection)
- **é—®é¢˜åé¦ˆ**: [Issues](https://github.com/oyport/traffic-limit-protection/issues)

---

<div align="center">

**å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸€ä¸ª â­ Starï¼**

Made with â¤ï¸ by oyport

</div>
